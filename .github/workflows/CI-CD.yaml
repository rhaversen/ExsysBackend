name: CI/CD

on:
    push:
        branches: ["main", "staging"]

jobs:
    build-and-deploy:
        uses: rhaversen/.github/.github/workflows/ci-cd.yml@main
        with:
            project_name: "ExsysBackend"
            dockerhub_image_name: "exsys-backend"
            node_version: "lts/*"
            push_sourcemaps: true
            sentry_project: "exsys-backend"
        secrets:
            DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
            DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
            SENTRY_AUTH_TOKEN: ${{ secrets.SENTRY_AUTH_TOKEN }}
            DEVOPS_REPO_TOKEN: ${{ secrets.DEVOPS_REPO_TOKEN }}
